<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="IE=edge" />
    <title>定制化仿真包</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="Shortcut Icon" href="/favicon.ico" />
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <link rel="stylesheet" href="/stylesheets/styles.css" />
  </head>

  <body>
    <header class="q-header">
      <h3 onclick="javascript:window.location.href='/'">
        <svg class="logo-icon" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
          <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
        </svg>
        Web包在线预览
      </h3>
      <div class="header-actions">
        <div id="q-upload"></div>
        <input type="text" id="search" placeholder="搜索..." />
        <button id="theme-toggle" class="theme-btn" title="切换主题">
          <svg class="icon-sun" viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
            <path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/>
          </svg>
          <svg class="icon-moon" viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
            <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/>
          </svg>
        </button>
      </div>
    </header>
    <main>
      <%-body%>
    </main>
    <script>
      // 主题切换功能
      (function() {
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        
        // 获取系统主题偏好
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
        
        // 从localStorage获取用户设置，否则跟随系统
        function getTheme() {
          const saved = localStorage.getItem('theme');
          if (saved) return saved;
          return prefersDark.matches ? 'dark' : 'light';
        }
        
        // 应用主题
        function applyTheme(theme) {
          html.setAttribute('data-theme', theme);
        }
        
        // 初始化
        applyTheme(getTheme());
        
        // 切换主题
        themeToggle.addEventListener('click', function() {
          const current = html.getAttribute('data-theme');
          const next = current === 'dark' ? 'light' : 'dark';
          applyTheme(next);
          localStorage.setItem('theme', next);
        });
        
        // 监听系统主题变化（仅当用户未手动设置时）
        prefersDark.addEventListener('change', function(e) {
          if (!localStorage.getItem('theme')) {
            applyTheme(e.matches ? 'dark' : 'light');
          }
        });
      })();
      
      window.enableUpload = function () {
        const domStr = `<form
            class="q-form"
            method="POST"
            action="/upload"
            enctype="multipart/form-data"
          >
            <a href="javascript:;" class="file"
              >上传文件包
              <input type="file" name="file" id="file" />
            </a>
          </form>`;
        $("#q-upload").empty();
        $(domStr).appendTo($("#q-upload"));
        $(".q-form").on("change", "input[type='file']", function () {
          $(".q-form").submit();
        });
      };
    </script>
  </body>
</html>
